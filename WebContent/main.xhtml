<ui:composition xmlns="http://www.w3.org/1999/xhtml" xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html" xmlns:p="http://primefaces.org/ui" xmlns:f="http://java.sun.com/jsf/core"
	xmlns:b="http://bootsfaces.net/ui" template="/WEB-INF/templates/basicTemplate.xhtml">

	<ui:define name="extraHead">
		<style>
.ui-layout-unit-content .ui-widget-content {
	padding: 0px;
	margin: 0px;
}
</style>
		<script name="jquery/jquery.js" library="primefaces"></script>
		<script>
			function next() {
				console.log('next');
				PF('wizard').next();
				PF('stepsInFlow').setActiveIndex(2);
			}

			function back() {
				console.log('back');
				PF('wizard').back();
				PF('stepsInFlow').setActiveIndex(3);
			}

			function goToStep(step) {
				console.log('Moving to step: ' + step);
				wizard = PF('wizard');
				wizard.loadStep(wizard.cfg.steps[step], true);
			}
			function resetWizard() {
				console.log('reset');
				wizard = PF('wizard');
				console.log(wizard.cfg.steps);
				wizard.loadStep(wizard.cfg.steps[0], true);
				//PF('wiz').loadStep('tabId',false);
			}
		</script>
	</ui:define>


	<ui:define name="content">
		<center>

			<div style="width: 500px">
				<!-- 
				<input value="Prev" type="button" onclick="back();" /> <input value="Next" type="button" onclick="next();" />
 				-->
				<p:growl id="growl" sticky="true" showDetail="true" />
				<p:wizard widgetVar="wizard" showNavBar="true" flowListener="#{businessFLowView.onFlowProcess}" id="wizard">

					<p:tab id="uploadFile" title="#{msg['flow.step1']}">
						<p:panel header="Personal Details">
							<p:messages />
							<p:panelGrid columns="2">
								<p:outputLabel value="#{msg['main.fileNameToUpload']}" />

								<p:fileUpload fileUploadListener="#{businessFLowView.handleFileUpload}" mode="advanced" dragDropSupport="false"
									update="uploadMessage" sizeLimit="100000" fileLimit="1" allowTypes="/(\.|\/)(gif|jpe?g|png)$/">
									<p:growl id="uploadMessage" showDetail="true" />
								</p:fileUpload>

							</p:panelGrid>
						</p:panel>
					</p:tab>
					<p:tab id="reviewFile" title="#{msg['flow.step2']}">
						<p:panel>
							<p:messages />
							<p:panelGrid columns="2">
								<p:outputLabel value="#{msg['main.fileNameToDownload']}" />
								<p:commandButton value="Download" ajax="false" onclick="PrimeFaces.monitorDownload(start, stop);"
									icon="ui-icon-arrowthick-1-s">
									<p:fileDownload value="#{businessFLowView.downloadedFile}" />
								</p:commandButton>
								<h:outputText value="#{msg['main.fileValid']}" />
								<h:selectBooleanCheckbox value="#{businessFLowView.validFile}" label="Firstname" />
							</p:panelGrid>
						</p:panel>
					</p:tab>
					<p:tab id="sendFile" title="#{msg['flow.step3']}">
						<p:panel>
							<p:messages />
							<p:panelGrid columns="2">
								<p:outputLabel value="#{msg['flow.step2']}" />
								<h:inputText value="#{businessFLowView.uploadedDate}" required="true" label="Firstn2ame">
									<p:ajax event="keyup" update="grid" />
								</h:inputText>
							</p:panelGrid>
						</p:panel>
					</p:tab>
					<p:tab id="showResponse" title="#{msg['flow.step4']}">
						<p:panel>
							<p:messages />
							<p:panelGrid columns="2">
								<p:outputLabel value="#{msg['flow.step3']}" />
								<h:form enctype="multipart/form-data">
									<h:commandButton value="#{msg['main.send']}" action="#{businessFLowView.register}" onclick="resetWizard();"
										ajax="true"></h:commandButton>
								</h:form>
							</p:panelGrid>
						</p:panel>
					</p:tab>

				</p:wizard>

				<br /> <br />
				<h:panelGrid id="grid" cellpadding="5" columns="2" style="margin-bottom:10px">
					<p:dataTable value="#{businessFLowView.logs}" var="logEntries" scrollable="true" scrollHeight="150">
						<f:facet name="header">
							<p:outputLabel value="#{msg['logPanel.title']}" />
						</f:facet>
						<p:column headerText="#{msg['main.log.date']}">
							<h:outputText value="#{logEntries.date}" />
						</p:column>
						<p:column headerText="#{msg['main.log.event1']}">
							<h:outputText value="#{logEntries.message}" />
						</p:column>
						<p:column headerText="#{msg['main.log.event2']}">
							<h:outputText value="#{logEntries.level}" />
						</p:column>
					</p:dataTable>
				</h:panelGrid>

			</div>
		</center>
	</ui:define>

</ui:composition>
